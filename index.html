<!DOCTYPE html>
<html>
<head>
    <title>HealthBot</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        .light {
            background-color: #f0f4f8;
            color: #334155;
        }
        .dark {
            background-color: #1e293b;
            color: #e2e8f0;
        }
    </style>
</head>
<body class="light flex flex-col items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl bg-white dark:bg-slate-800 rounded-2xl shadow-xl flex flex-col h-[80vh]">
        
        <!-- Header -->
        <div class="p-4 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between">
            <h1 class="text-2xl font-bold text-slate-900 dark:text-white">
                <span role="img" aria-label="HealthBot icon">
                    &#x1F916;
                </span> HealthBot
            </h1>
            <button id="theme-toggle" class="p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>
        </div>

        <!-- Chat Area -->
        <div id="chatbox" class="flex-1 p-4 overflow-y-auto space-y-4">
            <!-- Chat messages will be appended here -->
            <div class="msg bot bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-white rounded-xl p-3 max-w-[75%]">
                Hello! I'm your HealthBot. How can I assist you today?
            </div>
        </div>

        <!-- Input Area -->
        <div class="p-4 border-t border-slate-200 dark:border-slate-700 flex items-center space-x-2">
            <input type="text" id="user-input" placeholder="Type your message..." class="flex-1 p-3 rounded-xl border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-700 text-slate-800 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <button onclick="sendMessage()" class="bg-blue-600 text-white rounded-xl p-3 px-6 hover:bg-blue-700 transition-colors">
                Send
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userInput = document.getElementById('user-input');
            userInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    sendMessage();
                }
            });
        });

        function appendMessage(sender, text) {
            const chatbox = document.getElementById('chatbox');
            const msg = document.createElement('div');
            const isBot = sender === 'HealthBot';
            
            msg.className = `msg p-3 rounded-xl max-w-[75%] ${isBot ? 'bot bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-white self-start' : 'you bg-blue-500 text-white self-end'}`;
            msg.textContent = text;
            chatbox.appendChild(msg);
            chatbox.scrollTop = chatbox.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('user-input');
            const message = input.value.trim();
            if (!message) return;
            appendMessage('You', message);
            input.value = '';

            try {
                const response = await fetch('/ask', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message })
                });
                const data = await response.json();
                appendMessage('HealthBot', data.reply);
            } catch (error) {
                console.error('Error sending message:', error);
                appendMessage('HealthBot', 'Sorry, I am unable to connect right now. Please try again later.');
            }
        }

        document.getElementById('theme-toggle').addEventListener('click', () => {
            document.body.classList.toggle('dark');
            document.body.classList.toggle('light');
        });
    </script>
</body>
</html>

